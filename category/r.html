<!DOCTYPE html>
<html lang="en">
<head>
        <meta charset="utf-8" />
        <title>jrnew - R</title>
        <link rel="stylesheet" href="http://www.jrnew.me/theme/css/main.css" />
        <link href="http://www.jrnew.me/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="jrnew Atom Feed" />

        <!--[if IE]>
            <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
        <![endif]-->
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="http://www.jrnew.me/">jrnew </a></h1>
                <nav><ul>
                    <li class="active"><a href="http://www.jrnew.me/category/r.html">R</a></li>
                </ul></nav>
        </header><!-- /#banner -->

            <aside id="featured" class="body">
                <article>
                    <h1 class="entry-title"><a href="http://www.jrnew.me/state-of-the-union.html">The State of the Union is dumber</a></h1>
<footer class="post-info">
        <abbr class="published" title="2014-10-06T00:00:00">
                Published: Mon 06 October 2014
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="http://www.jrnew.me/author/jrnew.html">jrnew</a>
        </address>
<p>In <a href="http://www.jrnew.me/category/r.html">R</a>. </p>

</footer><!-- /.post-info --><p>I got the idea of calculating the <a href="http://en.wikipedia.org/wiki/Flesch%E2%80%93Kincaid_readability_tests" title="Fleisch-Kincaid readability test">Fleisch-Kincaid readability test</a> score for all State of the Union Addresses after reading about how <a href="https://medium.com/@johnnylin/going-from-nothing-to-product-hunt-in-4-hours-89cfb67977b3" title="Johnny Lin">it was used</a> to calculate the average U.S. grade level of a user's tweets in <a href="http://www.beakscore.com/" title="Beak">Beak</a>. After some googling, it turns out <a href="http://www.theguardian.com/world/interactive/2013/feb/12/state-of-the-union-reading-level" title="The Guardian">The Guardian</a> already beat me to it, but this still makes for a fun exercise.</p>
<div class="highlight"><pre>library<span class="p">(</span>XML<span class="p">)</span>
library<span class="p">(</span>stringr<span class="p">)</span>
library<span class="p">(</span>koRpus<span class="p">)</span>
library<span class="p">(</span>ggplot2<span class="p">)</span>
library<span class="p">(</span>gridExtra<span class="p">)</span>
source<span class="p">(</span><span class="s">&quot;R/speech-functions.R&quot;</span><span class="p">)</span>
output_dir <span class="o">&lt;-</span> <span class="s">&quot;output&quot;</span>
<span class="c1"># Get list of speech objects</span>
dir.create<span class="p">(</span>output_dir<span class="p">,</span> showWarnings <span class="o">=</span> <span class="kc">FALSE</span><span class="p">)</span>
<span class="kr">if</span> <span class="p">(</span><span class="o">!</span>file.exists<span class="p">(</span>file.path<span class="p">(</span>output_dir<span class="p">,</span> <span class="s">&quot;speech_list_all.rda&quot;</span><span class="p">)))</span> <span class="p">{</span>
  urls_speech <span class="o">&lt;-</span> GetSpeechURLs<span class="p">()</span>
  speech_list_all <span class="o">&lt;-</span> lapply<span class="p">(</span>urls_speech<span class="p">,</span> GetAndProcessSpeech<span class="p">)</span>
  names<span class="p">(</span>speech_list_all<span class="p">)</span> <span class="o">&lt;-</span> sapply<span class="p">(</span>speech_list_all<span class="p">,</span> <span class="kr">function</span><span class="p">(</span>speech_list<span class="p">)</span> 
    paste<span class="p">(</span>speech_list<span class="o">$</span>speech_data_scalar<span class="o">$</span>president<span class="p">,</span> speech_list<span class="o">$</span>speech_data_scalar<span class="o">$</span>year<span class="p">))</span>
  save<span class="p">(</span>speech_list_all<span class="p">,</span> file <span class="o">=</span> file.path<span class="p">(</span>output_dir<span class="p">,</span> <span class="s">&quot;speech_list_all.rda&quot;</span><span class="p">))</span>
<span class="p">}</span> <span class="kr">else</span> <span class="p">{</span>
  load<span class="p">(</span>file.path<span class="p">(</span>output_dir<span class="p">,</span> <span class="s">&quot;speech_list_all.rda&quot;</span><span class="p">))</span>
<span class="p">}</span>
<span class="c1"># Get speech data frame</span>
<span class="kr">if</span> <span class="p">(</span><span class="o">!</span>file.exists<span class="p">(</span>file.path<span class="p">(</span>output_dir<span class="p">,</span> <span class="s">&quot;speech_df.rda&quot;</span><span class="p">)))</span> <span class="p">{</span>
  speech_df <span class="o">&lt;-</span> GetSpeechDataFrame<span class="p">(</span>speech_list_all<span class="p">)</span>
  save<span class="p">(</span>speech_df<span class="p">,</span> file <span class="o">=</span> file.path<span class="p">(</span>output_dir<span class="p">,</span> <span class="s">&quot;speech_df.rda&quot;</span><span class="p">))</span>
<span class="p">}</span> <span class="kr">else</span> <span class="p">{</span>
  load<span class="p">(</span>file.path<span class="p">(</span>output_dir<span class="p">,</span> <span class="s">&quot;speech_df.rda&quot;</span><span class="p">))</span>
<span class="p">}</span>
</pre></div>


<p>Final plot:</p>
<div class="highlight"><pre><span class="c1"># F-K readability vs year bubble charts</span>
speech_df<span class="o">$</span>num_words_scaled <span class="o">&lt;-</span> sqrt<span class="p">(</span>speech_df<span class="o">$</span>num_words<span class="o">/</span>pi<span class="p">)</span>
p <span class="o">&lt;-</span> ggplot<span class="p">(</span>speech_df<span class="p">,</span> 
            aes_string<span class="p">(</span>x <span class="o">=</span> <span class="s">&quot;year&quot;</span><span class="p">,</span> y <span class="o">=</span> <span class="s">&quot;readability_grade&quot;</span><span class="p">,</span> 
                       color <span class="o">=</span> <span class="s">&quot;president&quot;</span><span class="p">,</span> size <span class="o">=</span> <span class="s">&quot;num_words_scaled&quot;</span><span class="p">))</span> <span class="o">+</span>
  geom_point<span class="p">(</span>alpha <span class="o">=</span> <span class="m">0.5</span><span class="p">)</span> <span class="o">+</span>
  xlab<span class="p">(</span><span class="s">&quot;Year of address&quot;</span><span class="p">)</span> <span class="o">+</span> ylab<span class="p">(</span><span class="s">&quot;Flesch-Kincaid readability score\n(U.S. grade level)&quot;</span><span class="p">)</span> <span class="o">+</span> 
  scale_size_continuous<span class="p">(</span>name <span class="o">=</span> <span class="s">&quot;# words&quot;</span><span class="p">,</span> 
                        breaks <span class="o">=</span> sqrt<span class="p">(</span>c<span class="p">(</span><span class="m">2500</span><span class="p">,</span> <span class="m">5000</span><span class="p">,</span> <span class="m">10000</span><span class="p">)</span><span class="o">/</span>pi<span class="p">),</span> 
                        labels <span class="o">=</span> c<span class="p">(</span><span class="m">2500</span><span class="p">,</span> <span class="m">5000</span><span class="p">,</span> <span class="m">10000</span><span class="p">))</span> <span class="o">+</span> 
  scale_colour_hue<span class="p">(</span>guide <span class="o">=</span> <span class="kc">FALSE</span><span class="p">)</span>
print<span class="p">(</span>p<span class="p">)</span>
</pre></div>


<p><img alt="plot of chunk plot" src="figure/plot.png" /> </p>                </article>
<p class="paginator">
    Page 1 / 1
</p>
            </aside><!-- /#featured -->
        <section id="extras" class="body">
                <div class="blogroll">
                        <h2>blogroll</h2>
                        <ul>
                            <li><a href="http://www.r-bloggers.com">R-bloggers</a></li>
                        </ul>
                </div><!-- /.blogroll -->
                <div class="social">
                        <h2>social</h2>
                        <ul>
                            <li><a href="http://www.jrnew.me/feeds/all.atom.xml" type="application/atom+xml" rel="alternate">atom feed</a></li>

                            <li><a href="http://twitter.com/jrnewww">Twitter @jrnewww</a></li>
                            <li><a href="http://github.com/jrnew">GitHub @jrnew</a></li>
                            <li><a href="https://www.linkedin.com/profile/view?id=146937887">LinkedIn</a></li>
                            <li><a href="http://www.researchgate.net/profile/Jin_Rou_New">ResearchGate</a></li>
                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a href="http://getpelican.com/">Pelican</a>, which takes great advantage of <a href="http://python.org">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a href="http://coding.smashingmagazine.com/2009/08/04/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

</body>
</html>